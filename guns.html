<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>AAJA Voices Data Viz Tutorial</title>
  </head>
  <body>
    

<h3>Analyzing and visualizing firearm background checks data</h3>
<p>We'll be creating a couple of dataviz using <a href="https://www.datawrapper.de/" target="_blank">Datawrapper</a> and <a href="https://flourish.studio/">Flourish</a>. Sign up for accounts in both.</p>
<p>Start with the FBI data, which comes in a PDF format</p>
<ul>
<li><a href="https://www.fbi.gov/file-repository/nics_firearm_checks_-_month_year_by_state_type.pdf/view" target="_blank">FBI.gov</a></li>
<li><a href="https://www.fbi.gov/file-repository/nics_firearm_checks_-_month_year_by_state_type.pdf" target="_blank">Link to the NICS_Firearm_Checks_-_Month_Year_by_State_Type.pdf </a>(right click and save)</li>
</ul>
<p>Convert it with Tabula.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a1.png" /></p>
<p>Alternatively, you can download the parsed and cleaned version it <a href="https://github.com/BuzzFeedNews/nics-firearm-background-checks" target="_blank">from Buzzfeed</a>.</p>
<ul>
<li>Right click and save <a href="https://github.com/BuzzFeedNews/nics-firearm-background-checks/blob/master/data/nics-firearm-background-checks.csv?raw=true" target="_blank">this file</a> to your computer</li>
</ul>
<p>Lots of data in here.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a2.png" /></p>
<p>There are many variables in here broken out by state and by month. </p>
<p><span style="font-size: 13px;">What questions can we ask it?</span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">What sorts of summaries could we come up with?</p>
<p><span style="font-size: 13px;">Let's start broadly.<br /></span></p>
<p><span style="font-size: 13px;">How have background checks evolved over time?</span></p>
<p><span style="font-size: 13px;">We can pivot table that.</span></p>
<p><span style="font-size: 13px;"><img src="http://andrewbatran.com/au-2017/slides/class11/images/a3.png" /></span></p>
<p><span style="font-size: 13px;">Months and sum of total permits should give us what we need.</span></p>
<p>Let's chart it out with a new service: <a href="https://www.datawrapper.de/" target="_blank">Datawrapper</a>.</p>
<h5>Time series chart with annotation</h5>
<p><a href="https://www.datawrapper.de/" target="_blank">Datawrapper</a> is a free (for now) data viz service tool created by someone who used to work at the New York Times.</p>
<p>Like plot.ly, Datawrapper has <a href="https://river.datawrapper.de/">a section</a> where they show off charts others have made and give them the option to "clone" it or see how they put it together so they can apply it to other data.</p>
<p>We have data for a time series chart and thinking ahead, we probably want to annotate it.</p>
<p>We're going to emulate this one found in the <a href="https://river.datawrapper.de/">river section</a>.</p>
<p><a href="river.datawrapper.de/_/Wa2Ci"><img src="http://andrewbatran.com/au-2017/slides/class11/images/a4.png" /></a></p>
<p></p>
<p>Log into Datawrapper and click on <strong>+ New Chart</strong> at the top.</p>
<p>Copy and paste the data over. Rename the headers generated by the pivot table to "Month" and "Checks"  and preserve the spacing of the text.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a8.png" /></p>
<p>Fortunately, Datawrapper is smart enough to detect that the data in the "Month" column are dates. Otherwise, you could manually tell Datawrapepr what the data type is by selecting it in the pulldown menu.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a9.png" /></p>
<p>Click the <strong>Proceed </strong>button on the left.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a10.png" /></p>
<p>Nice start. </p>
<p>What are those little peaks it seems that happens every year?</p>
<p>There's not enough information at the moment-- it just gives a year and the number of checks.</p>
<p>Click on the <strong>Refine</strong> tab and under the <em>Configure x-axis </em>subsection, select "2015, Feb, Mar" from the <b>Tick format<em></em></b> pulldown menu.</p>
<p>Okay, that's better. When the mouse hovers over the line it now includes month with the year.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a12.png" /></p>
<p>Every year, there's a spike in December for the holidays, presumably.</p>
<p>One thing is bothering me. This outlier.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a11.png" /></p>
<p>Click on <strong>Back</strong> on the bottom (twice) and delete that November 1998 row.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a13.png" /></p>
<p>Now proceed back to the chart and select <strong>Annotate</strong> and fill in all the details:</p>
<p>Title: Firearm background checks over time</p>
<p>Data source: NICS</p>
<p>Link to data source: https://www.fbi.gov/file-repository/nics_firearm_checks_-_month_year_by_state_type.pdf/view</p>
<p>Byline: Your name</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a14.png" /></p>
<p>Alright, that's a chart. </p>
<p>But what does it show?</p>
<p>That background checks are going up over time, which indicates more gun owners.</p>
<p>But by itself, this chart is shallow. A reader will naturally ask why. It needs context.</p>
<p>What explains those significantly large spikes?</p>
<p>Keep note of the peaks: November 2008, December 2012, December 2015.</p>
<p>What events in <a href="https://docs.google.com/spreadsheets/d/1XV4mZi3gYDgwx5PrLwqqHTUlHkwkV-6uy_yeJh3X46o/edit#gid=0">this spreadsheet</a> line up with those dates?</p>
<p><span style="font-size: 13px;">Let's add some annotations.</span></p>
<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; outline: 0px; font-weight: 400; font-style: normal; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; color: #000000; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;">Go to the <em>Highlight value ranges</em><em style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: italic; font-family: inherit; font-size: 13px;"><strong style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: bold; font-style: inherit; font-family: inherit; font-size: 13px;"></strong> </em>subsection under the<strong style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: bold; font-style: inherit; font-family: inherit; font-size: 13px;"> Annotate</strong> tab.<strong style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: bold; font-style: inherit; font-family: inherit; font-size: 13px;"><br /></strong></p>
<p>Click <strong>+ Add range highlight</strong> and select the first peak: 2008, November. </p>
<p>Change the color to red and move the opacity bar to midway.<br class="Apple-interchange-newline" /><br />Manually add the rest and fix the color and opacity to match:</p>
<ul>
<li>2008M11 - <span style="color: #000000; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">2008M11</span></li>
<li>2012M12 - <span style="color: #000000; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">2012M12</span></li>
<li><span style="color: #000000; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">2015M12 - 2015M12</span></li>
<li><span style="color: #000000; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">2018M2 - 2018M2</span></li>
</ul>
<p>Go to the <em><strong></strong>Text annotations </em>subsection under the<strong> Annotate</strong> tab.<strong><br /></strong></p>
<p>Click where to add the text so it makes sense.</p>
<p>Add these text points where appropriate.</p>
<ul>
<li>Obama elected</li>
<li>Sandy hook shooting</li>
<li>San Bernadino shooting</li>
<li>Parkland shooting</li>
</ul>
<p><strong>Important: </strong>To fit these text annotations, you'll need to go back to the <strong>Refine </strong>tab and change <strong></strong><em>Configure y-axis</em> under <strong>Custom range:</strong> to 4,000,000.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a15.png" /></p>
<p>This is how all those adjustments should look:</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/a16.png" /></p>
<p>Click on the <strong>Design </strong>tab and you should get some basic layout options. If you're premium, you can alter this so it has some custom colors based on values you preset.</p>
<p>Click the <strong>Publish </strong>button.</p>
<p><strong>Publish</strong> one more time to get the share url and the embed code.</p>
<p><iframe id="datawrapper-chart-Sxn7n" width="320" height="400" style="width: 0; min-width: 100% !important;" src="//datawrapper.dwcdn.net/Sxn7n/1/" scrolling="no" frameborder="0" allowtransparency="true"></iframe></p>
<h5>Small multiples charts</h5>
<p>Let's break it down to see if we can see deeper patterns.</p>
<p>We'll use <a href="https://flourish.studio/">Flourish</a> to create small multiples of the timeline, breaking out each state individually.</p>
<p>First, we need to prepare the data some more.</p>
<p>Let's get rid of all columns except month, state, and total.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h1.png" /></p>
<p>Now, let's reshape the data so the states are in the columns. Flourish needs wide data, not tall data, for small multiples.</p>
<p>We'll use our favorite tool: Pivot tables.</p>
<p>Move <em>state</em> into <strong>Columns </strong>and <em>month</em> into <strong>Rows</strong> and <em>Sum of totals</em> in <strong>Values.</strong></p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h2.png" /></p>
<p>Nice.</p>
<p>Move into a new sheet and clean it up:</p>
<ul>
<li>Change the first column name to "month"</li>
<li>Get rid of the first row for 1998-11 because it's an outlier that will throw everything off</li>
<li>Delete columns: Guam, Mariana Islands, Virgin Islands, Blank, and Grand Totals</li>
<li>Make sure there's nothing past 2018-03 in Row 233. Otherwise you've included the grand total rows</li>
</ul>
<p>MORE stuff we have to do:</p>
<ul>
<li>We need to turn the year-month format in column A into something Flourish can recognize</li>
<li>This is annoying and tricky</li>
<li>Insert a new column between Month and Alabama</li>
<li>Type in this formula in B2: =CONCATENATE(RIGHT(A2, 2), "/1/",LEFT(A2,4))</li>
<li>Apply it down</li>
</ul>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h6.png" />]</p>
<p><span style="font-size: 13px;"></span>Copy and paste values of the new column.</p>
<p>Save the sheet as<a href="http://andrewbatran.com/au-2017/slides/class11/images/state_backgrounds.xlsx" target="_blank"> state_backgrounds.xlsx<br /></a></p>
<p>Log into Flourish and in projects click the <strong>New</strong> button under Visualizations.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h3.png" /></p>
<p>Select line, bar and pie charts.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h4.png" /></p>
<p>Click on the <strong>Data</strong> tab.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h5.png" /></p>
<p>Click on Import. Upload state_backgrounds.xlsx.</p>
<p>Select the state_backgrounds sheet only. (Yes to overwrite current sheet)</p>
<p>Next to <strong>Labels</strong> type in <em>B </em>because that's the column where the labels are.</p>
<p>Next to <strong>Values</strong> type in <em>C-BB</em> because that's where the values are for the states.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h7.png" /></p>
<p>Now click on the <strong>Preview</strong> tab.</p>
<p>Make sure you have Grid of charts view on.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h8.png" /></p>
<p>The dots get in the way a bit. Go to <strong>Chart Styles</strong> on the right and change <strong>Radius</strong> under Dots from 3 to 0.</p>
<p><img src="http://andrewbatran.com/au-2017/slides/class11/images/h9.png" /></p>
<p>That's better.</p>
<p>Alright, this is a start.</p>
<p>Name the viz "Background checks by state"</p>

<p></p>
<p>What can we see?</p>
<p>Kentucky's really spiked over time.</p>
<p>North Carolina had a huge spike but maybe that's an outlier?</p>
<p>Same with Utah. Seems outlier-ish.</p>
<p>Illinois background checks have been increasing steadily.</p>
<p>What else?</p>
<p>Small states like North Dakota and Montana look like a low line so maybe the checks need to be adjusted?</p>
<p>Or maybe instead of all 50, there's a logical way to narrow down to a handful of states?</p>
<p>Just things to consider.</p>
<p></p>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  </body>
</html>
